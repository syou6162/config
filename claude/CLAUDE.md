## 全般的なルール

- 日本語で返答してください
- 手順が複雑になる場合、実行の前にチェックリストを作成し、方針が問題ないかをユーザーに尋ねてください
- ユーザーが「k」とだけ発言した際は「ok」や「問題ありません」の意味です
  - 一文字で入力できて便利なため、ユーザーはこういった表現を使います
- 実装中に技術的に詰まったところやわからないところ、解決できないエラーなどがあればcodex mcp(`mcp__codex__codex`)に英語で相談してください
  - ただし、codexの回答も鵜呑みにせず、「回答の信頼性に関するルール」に従って検証すること
  - codexの提案を採用する場合は、内容を理解した上で自分の言葉で説明すること
- Golang / Python / TypeScriptのプロジェクトでは積極的にserena mcp(`mcp__serena__read_memory`など)を活用してください

## 回答の信頼性に関するルール

### 基本姿勢
- 検証なしに回答しない
- 推測や憶測で回答する場合は、その旨を明示する
- わからないことは「わかりません」と正直に伝える

### 信頼される回答をするための要件

1. 信頼できる情報源の明示
   - 判断根拠となる情報源を以下の優先順位で参照し、URLを明記すること:
     1. 公式ドキュメント(manページ、公式サイト、公式リポジトリのREADMEなど)
     2. RFC、ベンダーブログ、ソースコード
     3. GitHub issue(公式リポジトリのissue、PR)
     4. 信頼できるコミュニティ(Stack Overflow、技術ブログなど)
   - 上位の情報源が存在しない、または矛盾する場合は、次の優先順位の情報源を補助的に利用し、その旨を明示すること
   - 情報源が矛盾する場合は、矛盾内容と参照した各情報源を併記すること
   - 引用形式: 情報源の説明とURLをインラインで記載(例: 「公式ドキュメント(https://example.com/docs)によると...」)

2. 理路整然としたロジックの提示
   - なぜそのアプローチを選んだのか、論理的に説明すること
   - 推測や憶測ではなく、根拠に基づいた説明をすること

3. 実際の動作確認
   - 実行可能な場合: テストを実行し、再現方法(実行したコマンドや手順)と動作結果(出力、エラーメッセージなど)を明示すること
   - 実行不可能な場合: 「実行できません(理由: ...)」と明記し、検証をスキップすること
   - 確認が難しい内容については「確認が難しいため検証していません(理由: ...)」と正直に伝えること

## 開発手法に関するルール

### t_wada式TDD
- テストが存在するリポジトリでの実装では、t_wada式のTDD（テスト駆動開発）を実践してください
- テストが存在しないリポジトリでは、この手法を適用する必要はありません

t_wada式TDDの手順:
1. TODOリストの作成: 実装前に何をテストするかのTODOリストを作成し、小さなステップに分解
2. Red-Green-Refactorサイクル:
   - Red: 失敗するテストを先に書く
   - Green: テストが通る最小限のコードを書く
   - Refactor: コードを改善する
3. 実装アプローチ:
   - 仮実装: まず定数を返すなど最も単純な実装で緑にする
   - 三角測量: 複数のテストケースから一般化していく
   - 明白な実装: 自信があれば直接本実装を書く
4. 原則:
   - テストコードとプロダクションコードを交互に書く
   - 一度に一つのことだけに集中する
   - 小さく確実なステップで進める
   - テストが失敗している間はプロダクションコードを書かない

## Gitの操作に関するルール

### main/masterブランチでのコミット禁止
- `git commit`する際にmainブランチもしくはmasterブランチにいたら、`git commit`をやめましょう
  - 「git worktreeでworktreeを作るのを忘れていませんか?」とユーザーに指摘しましょう
  - ユーザーはブランチを切る際にgit worktreeを利用します。mainブランチもしくはmasterブランチにいたら、ユーザーが忘れている可能性が高いです

## ファイル操作に関するルール

### ファイルの新規作成・編集
- ファイルの新規作成や編集には専用ツール(Edit / Write)を使用してください
- bashのヒアドキュメントやリダイレクトを使わないでください
  - 悪い例: `cat <<EOF > file.txt`, `echo "content" > file.txt`
  - 良い例: Writeツールを使用
  - 理由: リダイレクトを使うとユーザーに許可を求める必要があり、手間がかかる
  - 専用ツールを使えば許可なしで操作できるため効率的

### コマンド出力をファイルに保存する場合
- コマンドの出力結果をファイルに保存したい場合は、`tee`と`> /dev/null`を組み合わせて使用してください
  - 悪い例: `gh pr diff > .claude/tmp/pr_diff.txt`
  - 良い例: `gh pr diff | tee .claude/tmp/pr_diff.txt > /dev/null`
  - 理由: `>`によるリダイレクトは許可が必要だが、`tee`の引数としてファイルパスを渡せば許可なしで操作できる

## Subagentの省略形

ユーザーが以下の省略形で指示した場合、対応するsubagentを使用してください:

- "commit" => `syou6162-plugin:semantic-commit`
- "check ci" => `syou6162-plugin:monitor-ci`
- "update pr" => `syou6162-plugin:update-pr-title-and-description`
